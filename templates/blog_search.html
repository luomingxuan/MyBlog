{% extends 'base.html' %}
{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <h1 class="mb-0">搜索结果</h1>
  <span class="text-muted">关键词：{{ query }}</span>
</div>
<div class="row g-3 cards-grid">
  {% for p in posts %}
  <div class="col-12 col-md-6 col-lg-4">
    <div class="card-item panel-glass p-3 d-flex justify-content-between align-items-center" tabindex="0">
      <a class="card-title-link home-title" href="{{ url_for('blog_bp.blog_view', slug=p.slug) }}">{{ p.title }}</a>
      {% if is_owner %}
      <a class="btn btn-sm btn-light" href="{{ url_for('blog_bp.blog_edit', slug=p.slug) }}">编辑</a>
      {% endif %}
    </div>
  </div>
  {% endfor %}
  {% if posts|length == 0 %}
  <div class="col-12"><div class="panel-glass p-3">无匹配结果</div></div>
  {% endif %}
</div>
<script>
  (function(){
    var items = document.querySelectorAll('.cards-grid .card-item');
    items.forEach(function(el){
      el.addEventListener('click', function(){
        items.forEach(function(i){ i.classList.remove('selected'); });
        el.classList.add('selected');
      });
      el.addEventListener('keydown', function(e){
        if(e.key === 'Enter' || e.key === ' '){
          items.forEach(function(i){ i.classList.remove('selected'); });
          el.classList.add('selected');
        }
      });
      el.addEventListener('mousemove', function(e){
        var r = el.getBoundingClientRect();
        var x = e.clientX - r.left;
        var y = e.clientY - r.top;
        var rx = ((y / r.height) - 0.5) * -6;
        var ry = ((x / r.width) - 0.5) * 6;
        el.style.transform = 'perspective(600px) rotateX(' + rx + 'deg) rotateY(' + ry + 'deg)';
      });
      el.addEventListener('mouseleave', function(){
        el.style.transform = '';
      });
    });
  })();
</script>
{% endblock %}
